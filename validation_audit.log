2025-06-25 11:31:12,784 - soc-cis-server - INFO - [<module>:388] - Starting SOC-to-CIS Mapping Server...
2025-06-25 11:31:12,784 - soc-cis-server - INFO - [<module>:389] - Framework file: Uploads\CIS.xlsx (exists: True)
2025-06-25 11:31:12,784 - soc-cis-server - INFO - [<module>:390] - OpenAI API Key configured: True
2025-06-25 11:31:12,785 - soc-cis-server - INFO - [<module>:391] - Test mode available at /test endpoint
2025-06-25 11:31:22,964 - soc-cis-server - INFO - [test_process_pdf:228] - TEST MODE: Processing Oracle.pdf (pages 36-81)
2025-06-25 11:31:22,965 - soc-cis-server - INFO - [test_process_pdf:239] - Serving existing report: final.xlsx
2025-06-25 11:31:22,965 - soc-cis-server - INFO - [test_process_pdf:248] - TEST MODE: Successfully processed Oracle.pdf in 2.0 seconds
2025-06-25 11:33:58,221 - soc-cis-server - INFO - [test_process_pdf:228] - TEST MODE: Processing Oracle.pdf (pages 36-81)
2025-06-25 11:33:58,222 - soc-cis-server - INFO - [test_process_pdf:239] - Serving existing report: final.xlsx
2025-06-25 11:33:58,222 - soc-cis-server - INFO - [test_process_pdf:248] - TEST MODE: Successfully processed Oracle.pdf in 2.0 seconds
2025-06-25 11:36:23,003 - soc-cis-server - INFO - [test_process_pdf:228] - TEST MODE: Processing Oracle.pdf (pages 36-81)
2025-06-25 11:36:23,004 - soc-cis-server - INFO - [test_process_pdf:239] - Serving existing report: final.xlsx
2025-06-25 11:36:23,004 - soc-cis-server - INFO - [test_process_pdf:248] - TEST MODE: Successfully processed Oracle.pdf in 2.0 seconds
2025-06-25 11:55:09,166 - soc-cis-server - INFO - [test_process_pdf:228] - TEST MODE: Processing Oracle.pdf (pages 36-81)
2025-06-25 11:55:09,166 - soc-cis-server - INFO - [test_process_pdf:239] - Serving existing report: final.xlsx
2025-06-25 11:55:09,166 - soc-cis-server - INFO - [test_process_pdf:248] - TEST MODE: Successfully processed Oracle.pdf in 2.0 seconds
2025-06-25 11:57:09,341 - llm - WARNING - [signal_handler:48] - Received signal 2, initiating graceful shutdown...
2025-06-25 12:38:04,148 - __main__ - INFO - [validate_dataframe:507] - Starting concurrent validation of 830 control pairs
2025-06-25 12:38:04,149 - __main__ - INFO - [validate_dataframe:508] - Using 5 concurrent threads
2025-06-25 12:38:04,169 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:04,169 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:04,170 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:04,170 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:04,170 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:05,170 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:05,170 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:05,171 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:05,175 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:05,175 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:07,183 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:07,184 - __main__ - ERROR - [validate_dataframe:578] - Validation failed for 1.1->ID.AM-07: 'PromptConstructor' object has no attribute 'create_validation_prompt'
2025-06-25 12:38:07,184 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:07,184 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:07,184 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:07,184 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:07,184 - __main__ - ERROR - [validate_dataframe:578] - Validation failed for 1.1->ID.AM-02: 'PromptConstructor' object has no attribute 'create_validation_prompt'
2025-06-25 12:38:07,185 - __main__ - ERROR - [validate_dataframe:578] - Validation failed for 1.1->ID.AM-01: 'PromptConstructor' object has no attribute 'create_validation_prompt'
2025-06-25 12:38:07,185 - __main__ - ERROR - [validate_dataframe:578] - Validation failed for 1.1->ID.AM-04: 'PromptConstructor' object has no attribute 'create_validation_prompt'
2025-06-25 12:38:07,185 - __main__ - ERROR - [validate_dataframe:578] - Validation failed for 1.1->ID.AM-03: 'PromptConstructor' object has no attribute 'create_validation_prompt'
2025-06-25 12:38:08,184 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:08,185 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:08,185 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:08,185 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:08,185 - __main__ - WARNING - [wrapper:140] - Attempt 2 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 2.0s...
2025-06-25 12:38:10,184 - __main__ - WARNING - [wrapper:140] - Attempt 1 failed: 'PromptConstructor' object has no attribute 'create_validation_prompt'. Retrying in 1.0s...
2025-06-25 12:38:10,185 - __main__ - WARNING - [signal_handler:48] - Received signal 2, initiating graceful shutdown...
2025-06-25 12:38:11,200 - __main__ - INFO - [validate_dataframe:632] - Validation complete. Processed 5 results
2025-06-25 12:38:11,232 - __main__ - ERROR - [main:870] - Fatal error: Traceback (most recent call last):
  File "D:\EY\Framework-Mapper\llm.py", line 843, in main
    validated_df.to_xlsx(args.output, index=False)
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\aveng\AppData\Roaming\Python\Python313\site-packages\pandas\core\generic.py", line 6318, in __getattr__
    return object.__getattribute__(self, name)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
AttributeError: 'DataFrame' object has no attribute 'to_xlsx'

2025-06-25 12:38:11,232 - __main__ - INFO - [cleanup:684] - Performing cleanup...
